let filter:2 load "../list/filter";
let ansi:2 load "../cli/ansi";
let generate:3 load "../list/generate";

let LINE_WIDTH 80;

fn count(list value)
	size filter list fn(item)
		== item value
	;
;

fn format_results(results)
	+ "total: " + str size results + "  "
	+ ansi "green" + "success: " str count results true + "  "
	ansi "red" + "failure: " str count results false
;

fn group(name tests)
	if != "" name
		fn()
			outln
				+ tail generate nil ++ LINE_WIDTH fn() '='; + "\n"
				+ ansi "bold" name + "\n"
				tail generate nil ++ LINE_WIDTH fn() '-';
		;
		fn();

	let results tests;
	outln
		+ tail generate nil ++ LINE_WIDTH fn() '-'; + "\n"
		format_results results

	results
;
