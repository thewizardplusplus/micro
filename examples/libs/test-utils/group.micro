let ansi:2 load "ansi";
let generate:2 load "../list-utils/generate";
let count:2 load "../list-utils/count";

let LINE_WIDTH 80;

fn format_results(results)
	+ "total: " + str size results + "  "
	+ ansi "green" + "success: " str count results true + "  "
	ansi "red" + "failure: " str count results false
;

fn group(name tests)
	if != "" name
		fn()
			outln
				+ generate LINE_WIDTH '=' + "\n"
				+ ansi "bold" name + "\n"
				generate LINE_WIDTH '-'
		;
		fn();

	let results tests;
	outln
		+ generate LINE_WIDTH '-' + "\n"
		format_results results

	results
;
